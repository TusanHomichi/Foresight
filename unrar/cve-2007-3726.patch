Index: unrar/rarvm.cpp
===================================================================
--- unrar.orig/rarvm.cpp
+++ unrar/rarvm.cpp
@@ -843,7 +843,7 @@ void RarVM::ExecuteStandardFilter(VM_Sta
         int DataSize=R[4];
         uint FileOffset=R[6];
 
-        if (DataSize>=VM_GLOBALMEMADDR)
+        if (DataSize>=VM_GLOBALMEMADDR || DataSize < 4)
           break;
 
         const int FileSize=0x1000000;
@@ -889,7 +889,7 @@ void RarVM::ExecuteStandardFilter(VM_Sta
         int DataSize=R[4];
         uint FileOffset=R[6];
 
-        if (DataSize>=VM_GLOBALMEMADDR)
+        if (DataSize>=VM_GLOBALMEMADDR || DataSize < 21)
           break;
 
         uint CurPos=0;

