diff -r 928fd7147466 src/zicc.c
--- a/src/zicc.c	Mon Feb 18 17:29:59 2008 -0900
+++ b/src/zicc.c	Mon Feb 18 17:30:52 2008 -0900
@@ -77,6 +77,9 @@ zseticcspace(i_ctx_t * i_ctx_p)
     dict_find_string(op, "N", &pnval);
     ncomps = pnval->value.intval;
 
+    if (2*ncomps > sizeof(range_buff)/sizeof(float))
+	return_error(e_rangecheck);
+
     /* verify the DataSource entry */
     if (dict_find_string(op, "DataSource", &pstrmval) <= 0)
         return_error(e_undefined);
