
https://bugzilla.redhat.com/show_bug.cgi?id=556415 

--- expat-1.95.8/lib/xmlparse.c.cve3560-revised
+++ expat-1.95.8/lib/xmlparse.c
@@ -3615,6 +3615,9 @@ doProlog(XML_Parser parser,
         return XML_ERROR_UNCLOSED_TOKEN;
       case XML_TOK_PARTIAL_CHAR:
         return XML_ERROR_PARTIAL_CHAR;
+      case -XML_TOK_PROLOG_S:
+        tok = -tok;
+        break;
       case XML_TOK_NONE:
 #ifdef XML_DTD
         /* for internal PE NOT referenced between declarations */
